<html>
<head>
<script type="text/javascript">
function render(time) {
    console.log("rendering " + time);
    webvfx.getImage('sourceImage').assignToHTMLImageElement(sourceImage);
    webvfx.getImage('targetImage').assignToHTMLImageElement(targetImage);
    webvfx.getImage('demoImage').assignToHTMLImageElement(demoImage);
    context.drawImage(sourceImage, 0, 0, 160, 120)
    context.drawImage(targetImage, 160, 120, 160, 120)
    context.drawImage(demoImage, 0, 120, 160, 120)
    timeEl.innerHTML = time;
}

function init() {
    var canvas = document.getElementById("canvas");

    // globals
    context = canvas.getContext('2d');
    sourceImage = new Image();
    targetImage = new Image();
    demoImage = new Image();
    timeEl = document.getElementById("time");

    var title = webvfx.getStringParameter('title');
    var titleEl = document.getElementById("title");
    titleEl.innerHTML = title;

    webvfx.renderRequested.connect(render);
    webvfx.loadFinished(true, {
                               "sourceImage" : webvfx.SOURCE_IMAGE_TYPE,
                               "targetImage" : webvfx.TARGET_IMAGE_TYPE,
                               "demoImage" : webvfx.EXTRA_IMAGE_TYPE
                             });
}
window.addEventListener("load", init, false);
</script>
</head>
<body>
    Canvas time <span id="time">unset</span> title <span id="title">unset</span><br/>
    <canvas id="canvas" width="320" height="240" style="background-color: #DDDDDD;"></canvas>
</body>
</html>
