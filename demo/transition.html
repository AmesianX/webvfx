<html>
<head>
<script type="text/javascript">
function render(time) {
    console.log("rendering " + time);
    var srcImage = chromix.getImageParamValue('srcVideo');
    var dstImage = chromix.getImageParamValue('dstVideo');
    srcContext.putImageData(srcImage, 0, 0);
    dstContext.putImageData(dstImage, 0, 0);
    context.drawImage(srcContext.canvas, 0, 0, 160, 120)
    context.drawImage(dstContext.canvas, 160, 120, 160, 120)
    timeEl.innerHTML = time;
}

function init() {
    chromix.setRenderCallback(render);
    var canvas = document.getElementById("canvas");
    var srcCanvas = document.createElement('canvas');
    srcCanvas.width = 320;
    srcCanvas.height = 240;
    var dstCanvas = document.createElement('canvas');
    dstCanvas.width = 320;
    dstCanvas.height = 240;
    // globals
    context = canvas.getContext('2d');
    srcContext = srcCanvas.getContext('2d');
    dstContext = dstCanvas.getContext('2d');
    timeEl = document.getElementById("time");
    var title = chromix.getParamValue('title');
    var titleEl = document.getElementById("title");
    titleEl.innerHTML = title;
}
window.addEventListener("load", init, false);
</script>
</head>
<body>
    Canvas time <span id="time">unset</span> title <span id="title">unset</span><br/>
    <canvas id="canvas" width="320" height="240" style="background-color: #0000FF;"></canvas>
</body>
</html>
